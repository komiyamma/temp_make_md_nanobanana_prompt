# ç¬¬21ç« ï¼šAPIã‚¨ãƒ©ãƒ¼è¨­è¨ˆâ‘  HTTPã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã®æ±ºã‚æ–¹ğŸš¦ğŸŒ

APIã®å¤±æ•—ã£ã¦ã€**ã€Œä»•æ§˜ã€**ã¨ã—ã¦æƒã£ã¦ãªã„ã¨ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå´ãŒã‚ã¡ã‚ƒãã¡ã‚ƒå›°ã‚‹ã®â€¦ğŸ˜µâ€ğŸ’«
ãã“ã§ä»Šæ—¥ã¯ **HTTPã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚’â€œè¿·ã‚ãšæ±ºã‚ã‚‹ãƒ«ãƒ¼ãƒ«â€** ã‚’ä½œã£ã¦ã€ã‚¨ãƒ©ãƒ¼ã‚«ã‚¿ãƒ­ã‚°ã«è²¼ã‚Œã‚‹çŠ¶æ…‹ã«ã™ã‚‹ã‚ˆğŸ“ŒğŸ’•

---

## 1) ä»Šæ—¥ã®ã‚´ãƒ¼ãƒ«ğŸ¯âœ¨

![HTTP Status Goal](./picture/err_model_cs_study_021_goal_status.png)

### ã§ãã‚‹ã‚ˆã†ã«ãªã‚‹ã“ã¨ğŸ˜Š

* ã‚¨ãƒ©ãƒ¼ã‚’è¦‹ã¦ã€Œä½•ç•ªã®ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã«ã™ã‚‹ï¼Ÿã€ã‚’åˆ¤æ–­ã§ãã‚‹ğŸš¦
* **ãƒ‰ãƒ¡ã‚¤ãƒ³ / ã‚¤ãƒ³ãƒ•ãƒ© / ãƒã‚°**ã®åˆ†é¡ã¨ã€**4xx / 5xx**ãŒãƒ–ãƒ¬ãªããªã‚‹ğŸ§­
* ã‚¨ãƒ©ãƒ¼ã‚«ã‚¿ãƒ­ã‚°ï¼ˆç¬¬13ç« ï¼‰ã« **Statusåˆ—**ã‚’è¶³ã—ã¦é‹ç”¨ã§ãã‚‹ğŸ“‹âœ¨

> ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã¯ã€Œéª¨æ ¼ã€ğŸ¦´ã§ã€ç´°ã‹ã„æƒ…å ±ã¯æ¬¡ç« ã® **ProblemDetailsï¼ˆRFC 9457ï¼‰** ã§è¿”ã™æ„Ÿã˜ã ã‚ˆğŸ§¾âœ¨ ([rfc-editor.org][1])

---

## 2) ã¾ãšå¤§åŸå‰‡ï¼š4xxã¨5xxã®å¢ƒç•Œç·šğŸ§ ğŸš§

![Traffic Lights 200/400/500](./picture/err_model_cs_study_021_http_traffic_lights.png)

HTTPã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã¯ã€Œèª°ãŒç›´ã™ã¹ãï¼Ÿã€ã‚’ä¼ãˆã‚‹è¨˜å·ã ã‚ˆğŸ“¶

* **4xxï¼ˆã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚¨ãƒ©ãƒ¼ï¼‰**ï¼šãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’ç›´ã—ã¦ã­ğŸ™ï¼ˆå…¥åŠ›ãƒ»æ¨©é™ãƒ»çŠ¶æ…‹ãŒåˆã‚ãªã„ç­‰ï¼‰
* **5xxï¼ˆã‚µãƒ¼ãƒãƒ¼ã‚¨ãƒ©ãƒ¼ï¼‰**ï¼šã‚µãƒ¼ãƒãƒ¼å´ã®å•é¡Œã ã‚ˆğŸ¥²ï¼ˆéšœå®³ãƒ»ä¾å­˜å…ˆãƒ»æƒ³å®šå¤–ãƒã‚°ï¼‰

ã“ã®åˆ†é¡è‡ªä½“ã‚‚ã€HTTPã®æ¨™æº–çš„ãªæ‰±ã„ã«æ²¿ã£ã¦ã‚‹ã‚ˆâœ¨ï¼ˆã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã¯RFC 9110ã§æ•´ç†ã•ã‚Œã¦ã‚‹ï¼‰ ([MDNã‚¦ã‚§ãƒ–ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ][2])

---

## 3) 3åˆ†é¡ï¼ˆãƒ‰ãƒ¡ã‚¤ãƒ³/ã‚¤ãƒ³ãƒ•ãƒ©/ãƒã‚°ï¼‰ã‹ã‚‰ã®æœ€çŸ­ãƒ«ãƒ¼ãƒˆğŸ—ºï¸âœ¨

ã‚ãªãŸã®ãƒ­ãƒ¼ãƒ‰ãƒãƒƒãƒ—ã®ã€Œ3åˆ†é¡ã€ã‚’ã€ãã®ã¾ã¾ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã«è½ã¨ã™ã¨ã“ã†ğŸ‘‡

### âœ… è¶…ã–ã£ãã‚Šå¯¾å¿œè¡¨ï¼ˆè¿·ã£ãŸã‚‰ã‚³ã‚³ã«æˆ»ã‚‹ï¼‰ğŸ§©

* **ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚¨ãƒ©ãƒ¼ï¼ˆæ¥­å‹™ãƒ«ãƒ¼ãƒ«é•åï¼‰** â†’ ã ã„ãŸã„ **4xx**ï¼ˆä¸»ã« 404 / 409 / 422 / 400ï¼‰ğŸ’—
* **ã‚¤ãƒ³ãƒ•ãƒ©ã‚¨ãƒ©ãƒ¼ï¼ˆDB/ãƒãƒƒãƒˆ/å¤–éƒ¨APIï¼‰** â†’ ã ã„ãŸã„ **5xx**ï¼ˆä¸»ã« 502 / 503 / 504ï¼‰ğŸŒ©ï¸
* **ãƒã‚°ï¼ˆä¸å¤‰æ¡ä»¶é•åï¼‰** â†’ **500**ï¼ˆFail Fastã§ãƒ­ã‚°ã¸ï¼‰âš¡

![Status Decision Tree](./picture/err_model_cs_study_021_status_decision_tree.png)

---

## 4) ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹æ±ºå®šã®â€œåˆ¤æ–­ãƒ•ãƒ­ãƒ¼â€ğŸš¦ğŸ”€ï¼ˆã“ã‚Œã‚’å‹ã«ã—ã‚ˆã†ï¼ï¼‰

![Status Decision Flowchart](./picture/err_model_cs_study_021_decision_flow.png)

è¿·ã£ãŸã‚‰ã“ã®é †ç•ªã§OKğŸ˜Š

1. **èªè¨¼ã„ã‚‹ï¼Ÿ** â†’ 401 / 403 ğŸ”
2. **ãã®ãƒªã‚½ãƒ¼ã‚¹ç„¡ã„ï¼Ÿ** â†’ 404 ğŸ”
3. **å…¥åŠ›ãŒå£Šã‚Œã¦ã‚‹ï¼Ÿï¼ˆå½¢å¼ï¼‰** â†’ 400 âœï¸
4. **å…¥åŠ›ã¯å½¢å¼OKã ã‘ã©ã€æ¥­å‹™çš„ã«ç„¡ç†ï¼Ÿ** â†’ 422ï¼ˆã¾ãŸã¯409ï¼‰ğŸ’—
5. **çŠ¶æ…‹ã®è¡çªï¼Ÿï¼ˆäºŒé‡ç™»éŒ²/åœ¨åº«ç«¶åˆ/æ¥½è¦³ãƒ­ãƒƒã‚¯ï¼‰** â†’ 409ï¼ˆæ¡ä»¶ä»˜ããªã‚‰412/428ã‚‚å€™è£œï¼‰âš”ï¸
6. **ãƒ¬ãƒ¼ãƒˆåˆ¶é™ï¼Ÿ** â†’ 429 ï¼‹ Retry-After â³
7. **ä¾å­˜å…ˆãŒã‚³ã‚±ãŸï¼Ÿï¼ˆå¤–éƒ¨API/ã‚²ãƒ¼ãƒˆã‚¦ã‚§ã‚¤ï¼‰** â†’ 502 ğŸŒğŸ’¥
8. **ä¸€æ™‚çš„ã«ç„¡ç†ï¼ˆDBè½ã¡/ãƒ¡ãƒ³ãƒ†/éè² è·ï¼‰** â†’ 503 ï¼‹ Retry-After ğŸ› ï¸
9. **ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆç³»** â†’ 504ï¼ˆã‚²ãƒ¼ãƒˆã‚¦ã‚§ã‚¤ï¼‰/ 408ï¼ˆè¦æ±‚å¾…ã¡ï¼‰âŒ›
10. **ãã‚Œä»¥å¤–ã®æƒ³å®šå¤–** â†’ 500 ğŸ˜‡ï¼ˆ=ãƒã‚°/æœªçŸ¥ã®äº‹æ•…ï¼‰

Retry-After ã¯ **429/503** ã§ã€Œã©ã‚Œãã‚‰ã„å¾…ã£ã¦ã­ã€ã‚’ä¼ãˆã‚‰ã‚Œã‚‹ã‚ˆâ³âœ¨ ([MDNã‚¦ã‚§ãƒ–ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ][3])

---

## 5) ã‚ˆãä½¿ã†ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ï¼šå®Ÿæˆ¦ã‚»ãƒƒãƒˆğŸ™âœ¨

![Status Icons Collection](./picture/err_model_cs_study_021_practical_icons.png)

ã€Œæ¨ã—æ´»ã‚°ãƒƒã‚ºè³¼å…¥ç®¡ç†ğŸ›ï¸ğŸ’–ã€ã£ã½ã„ä¾‹ã§ã„ãã­ï¼

| ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹                     | ã„ã¤ä½¿ã†ï¼Ÿ              | ä¾‹ï¼ˆæ¨ã—æ´»ï¼‰                     | ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã®è¡Œå‹•              |
| ------------------------- | ------------------ | -------------------------- | ---------------------- |
| 400 Bad Request           | å½¢å¼ãŒãƒ€ãƒ¡ï¼ˆå‹/å¿…é ˆ/JSONå£Šã‚Œï¼‰ | `quantity: "many"` ã¿ãŸã„ãªå‹é•ã„ | å…¥åŠ›ã‚’ç›´ã—ã¦å†é€âœï¸             |
| 401 Unauthorized          | èªè¨¼ã—ã¦ãªã„             | ãƒˆãƒ¼ã‚¯ãƒ³ç„¡ã—                     | ãƒ­ã‚°ã‚¤ãƒ³/å†èªè¨¼ğŸ”             |
| 403 Forbidden             | èªè¨¼ã¯ã‚ã‚‹ãŒæ¨©é™ãªã—         | ä»–äººã®è³¼å…¥å±¥æ­´ã«ã‚¢ã‚¯ã‚»ã‚¹               | æ¨©é™ä¸è¶³ã‚’è¡¨ç¤ºğŸ™…â€â™€ï¸           |
| 404 Not Found             | ãƒªã‚½ãƒ¼ã‚¹ãŒç„¡ã„            | `GET /items/999`           | å­˜åœ¨ã—ãªã„è¡¨ç¤ºğŸ”              |
| 409 Conflict              | çŠ¶æ…‹ã®è¡çªï¼ˆé‡è¤‡/ç«¶åˆï¼‰       | åœ¨åº«ãŒåŒæ™‚è³¼å…¥ã§è¶³ã‚Šãªããªã£ãŸ / äºŒé‡ç™»éŒ²     | çŠ¶æ…‹æ›´æ–°ã—ã¦ã‚„ã‚Šç›´ã—ğŸ”           |
| 422 Unprocessable Content | å½¢å¼OKã ãŒæ¥­å‹™çš„ã«ç„¡ç†       | äºˆç®—ã‚ªãƒ¼ãƒãƒ¼ / æœŸé™åˆ‡ã‚Œ              | å†…å®¹ã‚’å¤‰ãˆã¦å†é€ğŸ’—             |
| 429 Too Many Requests     | å©ãã™ã               | çŸ­æ™‚é–“ã«è³¼å…¥APIé€£æ‰“                | å¾…ã£ã¦å†è©¦è¡Œâ³                |
| 500 Internal Server Error | æƒ³å®šå¤–ï¼ˆãƒã‚°ï¼‰            | ä¸å¤‰æ¡ä»¶é•åãŒæ¼ã‚ŒãŸ                 | å†è©¦è¡Œã¯åŸºæœ¬NGãƒ»å•ã„åˆã‚ã›èª˜å°ğŸ˜µ     |
| 502 Bad Gateway           | ä¾å­˜å…ˆãŒå¤‰ãªå¿œç­”           | æ±ºæ¸ˆAPIãŒå£Šã‚ŒãŸ                  | å°‘ã—å¾…ã£ã¦/åˆ¥æ‰‹æ®µæ¡ˆå†…ğŸŒ          |
| 503 Service Unavailable   | ä¸€æ™‚çš„ã«ä½¿ãˆãªã„           | DBãƒ¡ãƒ³ãƒ†/éè² è·                  | å¾…ã£ã¦å†è©¦è¡Œï¼ˆRetry-Afterï¼‰ğŸ› ï¸ |
| 504 Gateway Timeout       | ä¾å­˜å…ˆãŒã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆ         | å¤–éƒ¨åœ¨åº«APIãŒé…ã™ã                | å¾…ã£ã¦å†è©¦è¡ŒâŒ›                |

ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ä¸€è¦§ã‚„å®šç¾©ã¯ã€MDNãŒRFC 9110ãƒ™ãƒ¼ã‚¹ã§ã¾ã¨ã¾ã£ã¦ã¦èª­ã¿ã‚„ã™ã„ã‚ˆğŸ“š ([MDNã‚¦ã‚§ãƒ–ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ][2])

---

## 6) ã€Œ409 vs 422ã€ã“ã“ãŒä¸€ç•ªè¿·ã†ã‚„ã¤ğŸ˜†ğŸ’¥

![409 vs 422](./picture/err_model_cs_study_021_409_vs_422.png)

### 409 Conflict ã‚’é¸ã³ã‚„ã™ã„ã‚±ãƒ¼ã‚¹âš”ï¸

* **ãƒªã‚½ãƒ¼ã‚¹ã®çŠ¶æ…‹ã¨è¡çª**ã—ã¦å‡¦ç†ã§ããªã„
  ä¾‹ï¼šåœ¨åº«ãŒã‚‚ã†ç„¡ã„ã€åŒæ™‚æ›´æ–°ã§ç«¶åˆã€äºŒé‡ä½œæˆãŒç™ºç”Ÿ

### 422 Unprocessable Content ã‚’é¸ã³ã‚„ã™ã„ã‚±ãƒ¼ã‚¹ğŸ’—

* å…¥åŠ›ã¯æ­£ã—ã„ã‘ã©ã€**æ¥­å‹™ãƒ«ãƒ¼ãƒ«çš„ã«æˆç«‹ã—ãªã„**
  ä¾‹ï¼šäºˆç®—ã‚ªãƒ¼ãƒãƒ¼ã€è³¼å…¥æœŸé™åˆ‡ã‚Œã€å¹´é½¢åˆ¶é™ãªã©

> è¿·ã£ãŸã‚‰ã“ã†è¦šãˆã‚‹ï¼š
> **409 = çŠ¶æ…‹ã®ã‚±ãƒ³ã‚«**âš”ï¸ / **422 = ãƒ«ãƒ¼ãƒ«é•å**ğŸ“ğŸ’—

---

## 7) ã‚¨ãƒ©ãƒ¼ã‚«ã‚¿ãƒ­ã‚°ã«ã€ŒStatusåˆ—ã€ã‚’è¶³ã™ğŸ“‹âœ¨ï¼ˆä»Šæ—¥ã®æˆæœç‰©ï¼‰

![Catalog Column Update](./picture/err_model_cs_study_021_catalog_column.png)

ç¬¬13ç« ã®ã‚¨ãƒ©ãƒ¼ã‚«ã‚¿ãƒ­ã‚°ãŒã“ã†ã„ã†åˆ—ã ã£ãŸã¨ã—ã¦ğŸ‘‡

* Code / Title / UserMessage / Detail / Retryable / Action â€¦

ã“ã“ã« **Status** ã‚’è¶³ã™ã‚ˆâœ…
ã•ã‚‰ã«ãŠã™ã™ã‚ã§ **Retry-Afterï¼ˆç§’ï¼‰** ã‚‚åˆ—ã§æŒã¤ã¨é‹ç”¨ãŒæ¥½â³âœ¨ï¼ˆ429/503ã§ä½¿ãˆã‚‹ï¼‰ ([MDNã‚¦ã‚§ãƒ–ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ][3])

---

## 8) ãƒŸãƒ‹æ¼”ç¿’âœï¸ğŸ“ï¼ˆStatusã‚’å‰²ã‚Šå½“ã¦ã‚ˆã†ï¼ï¼‰

æ¬¡ã®ã‚¨ãƒ©ãƒ¼ã«ã€ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚’æ±ºã‚ã¦ã¿ã¦ã­ğŸ˜Šï¼ˆç†ç”±ã‚‚1è¡Œã§ï¼ï¼‰

1. `ITEM_NOT_FOUND`ï¼ˆå•†å“IDãŒå­˜åœ¨ã—ãªã„ï¼‰
2. `INVALID_JSON`ï¼ˆJSONãŒå£Šã‚Œã¦ã‚‹ï¼‰
3. `BUDGET_EXCEEDED`ï¼ˆäºˆç®—ã‚ªãƒ¼ãƒãƒ¼ï¼‰
4. `OUT_OF_STOCK`ï¼ˆåœ¨åº«ä¸è¶³ï¼‰
5. `DUPLICATE_PURCHASE`ï¼ˆåŒä¸€è³¼å…¥ã®äºŒé‡é€ä¿¡ï¼‰
6. `UNAUTHENTICATED`ï¼ˆãƒ­ã‚°ã‚¤ãƒ³ã—ã¦ãªã„ï¼‰
7. `FORBIDDEN_ACCESS`ï¼ˆä»–äººã®è³¼å…¥ã«ã‚¢ã‚¯ã‚»ã‚¹ï¼‰
8. `RATE_LIMITED`ï¼ˆçŸ­æ™‚é–“ã«é€£æ‰“ï¼‰
9. `PAYMENT_PROVIDER_DOWN`ï¼ˆæ±ºæ¸ˆAPIãŒè½ã¡ã¦ã‚‹ï¼‰
10. `UNEXPECTED_NULL`ï¼ˆæƒ³å®šå¤–nullã§è½ã¡ãŸï¼‰

### ä¾‹ã®ç­”ãˆï¼ˆã“ã£ãã‚Šç­”ãˆåˆã‚ã›ï¼‰ğŸ‘€âœ¨

1=404ã€2=400ã€3=422ã€4=409ï¼ˆor 422ï¼‰ã€5=409ã€6=401ã€7=403ã€8=429ã€9=503 or 502ã€10=500
ï¼ˆ9ã¯ã€Œä¾å­˜å…ˆãŒè½ã¡ãŸ/å¤‰ãªå¿œç­”ã€ãªã‚‰ 502ã€ã€Œä¸€æ™‚çš„ã«åˆ©ç”¨ä¸å¯ã€ãªã‚‰ 503 ãŒå¤šã„ã‚ˆğŸŒğŸ› ï¸ï¼‰

---

## 9) å®Ÿè£…ã‚¤ãƒ¡ãƒ¼ã‚¸ï¼ˆResult â†’ HTTPï¼‰ğŸ§°âœ¨

![API Mapping Logic](./picture/err_model_cs_study_021_api_mapping.png)

ã“ã“ã§ã¯ã€Œã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã«å¤‰æ›ã™ã‚‹å ´æ‰€ã€ã‚’ **APIå¢ƒç•Œ**ã«ç½®ãã®ãŒãƒã‚¤ãƒ³ãƒˆã ã‚ˆğŸšª
ï¼ˆãƒ‰ãƒ¡ã‚¤ãƒ³ã‚„ã‚¢ãƒ—ãƒªå±¤ã¯ â€œHTTPã‚’çŸ¥ã‚‰ãªã„â€ ã¾ã¾ã«ã—ã¦å®ˆã‚‹ğŸ›¡ï¸ï¼‰

### æœ€å°APIã®ä¾‹ï¼šErrorCodeã§ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚’æ±ºã‚ã‚‹ğŸ¯

```csharp
app.MapPost("/purchases", async (CreatePurchaseRequest req, PurchaseService service) =>
{
    var result = await service.CreatePurchaseAsync(req);

    return result.Match(
        onSuccess: value => Results.Ok(value),
        onFailure: err =>
        {
            var status = err.Code switch
            {
                "INVALID_JSON" => StatusCodes.Status400BadRequest,
                "UNAUTHENTICATED" => StatusCodes.Status401Unauthorized,
                "FORBIDDEN_ACCESS" => StatusCodes.Status403Forbidden,
                "ITEM_NOT_FOUND" => StatusCodes.Status404NotFound,
                "DUPLICATE_PURCHASE" => StatusCodes.Status409Conflict,
                "OUT_OF_STOCK" => StatusCodes.Status409Conflict,
                "BUDGET_EXCEEDED" => StatusCodes.Status422UnprocessableEntity,
                "RATE_LIMITED" => StatusCodes.Status429TooManyRequests,
                "PAYMENT_PROVIDER_DOWN" => StatusCodes.Status503ServiceUnavailable,
                _ => StatusCodes.Status500InternalServerError
            };

            // ä»Šæ—¥ã¯ã€Œã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹æ±ºã‚ã€ãŒä¸»å½¹ãªã®ã§ãƒœãƒ‡ã‚£ã¯ä»®ã€‚
            // æ¬¡ç« ã§ ProblemDetails(RFC 9457) ã«ã™ã‚‹ã‚ˆğŸ§¾âœ¨
            return Results.StatusCode(status);
        }
    );
});
```

ASP.NET Coreå´ã§ã‚‚ã€Œã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãŒ400ä»¥ä¸Šï¼ã‚¨ãƒ©ãƒ¼çµæœã€ã¨ã—ã¦æ‰±ã„ã€ProblemDetailsç”Ÿæˆã®ä»•çµ„ã¿ãŒç”¨æ„ã•ã‚Œã¦ã‚‹ï¼ˆæ¬¡ç« ã§ã‚¬ãƒƒãƒ„ãƒªä½¿ã†ã‚ˆğŸ§¾ï¼‰ ([Microsoft Learn][4])

---

## 10) AIæ´»ç”¨ğŸ¤–ğŸ’¬ï¼ˆä»Šæ—¥ã®â€œã„ã„ä½¿ã„æ–¹â€ï¼‰

![AI Status Assistant](./picture/err_model_cs_study_021_ai_helper.png)

### âœ… å‰²ã‚Šå½“ã¦ã®ãƒ–ãƒ¬ã‚’æ¶ˆã™è³ªå•ãƒ†ãƒ³ãƒ—ãƒ¬ğŸ§ 

* ã€Œã“ã®ã‚¨ãƒ©ãƒ¼ã¯ *ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆãŒç›´ã™ï¼Ÿã‚µãƒ¼ãƒãƒ¼ãŒç›´ã™ï¼Ÿ* ã©ã£ã¡ï¼Ÿã€
* ã€Œ409ã¨422ã§è¿·ã£ã¦ã‚‹ã€‚çŠ¶æ…‹è¡çªï¼Ÿãƒ«ãƒ¼ãƒ«é•åï¼Ÿã§åˆ¤å®šã—ã¦ï¼ã€
* ã€Œã“ã®ã‚¨ãƒ©ãƒ¼ã«å¯¾ã—ã¦ã€ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆãŒå–ã‚‹ã¹ãè¡Œå‹•ã‚’1æ–‡ã§æ›¸ã„ã¦ï¼ã€

### âœ… ã‚¨ãƒ©ãƒ¼ã‚«ã‚¿ãƒ­ã‚°æ•´å½¢âœï¸

* ã€Œã“ã®Statuså‰²ã‚Šå½“ã¦ã®ç†ç”±ã‚’ã€APIä»•æ§˜æ›¸ã£ã½ã„çŸ­æ–‡ã«ã—ã¦ã€
* ã€ŒåŒã˜æ„å‘³ã®ã‚¨ãƒ©ãƒ¼ãŒé‡è¤‡ã—ã¦ãªã„ã‹ãƒã‚§ãƒƒã‚¯ã—ã¦ã€

---

## ã¾ã¨ã‚ğŸµâœ¨

* ã¾ãš **4xx/5xxã®å¢ƒç•Œ** ã‚’å›ºå®šã™ã‚‹ğŸš§
* æ¬¡ã« **404/409/422/429/503/502/500** ã‚ãŸã‚Šã®â€œå®šç•ªã‚»ãƒƒãƒˆâ€ã‚’æ¡ã‚‹ğŸ¤
* ãã—ã¦ã‚¨ãƒ©ãƒ¼ã‚«ã‚¿ãƒ­ã‚°ã« **Statusåˆ—** ã‚’è¶³ã—ã¦é‹ç”¨ã§ãã‚‹å½¢ã¸ğŸ“‹âœ¨
* ãƒœãƒ‡ã‚£ã®çµ±ä¸€ã¯æ¬¡ç« ã® **ProblemDetailsï¼ˆRFC 9457ï¼‰** ã§å®ŒæˆğŸ§¾ğŸ’•

---

æ¬¡ã®ç¬¬22ç« ã§ã¯ã€ä»Šæ—¥æ±ºã‚ãŸã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚’åœŸå°ã«ã—ã¦
**Result â†’ ProblemDetailsï¼ˆRFC 9457ï¼‰** ã®å¤‰æ›ãƒãƒƒãƒ—ã‚’ä½œã£ã¦ã€Œæ©Ÿæ¢°ã«ã‚‚äººã«ã‚‚å„ªã—ã„ã€ã‚¨ãƒ©ãƒ¼å¿œç­”ã«ä»•ä¸Šã’ã‚‹ã‚ˆã€œğŸ§¾âœ¨ğŸ’ª

[1]: https://www.rfc-editor.org/rfc/rfc9457.html?utm_source=chatgpt.com "RFC 9457: Problem Details for HTTP APIs"
[2]: https://developer.mozilla.org/en-US/docs/Web/HTTP/Reference/Status?utm_source=chatgpt.com "HTTP response status codes - MDN Web Docs - Mozilla"
[3]: https://developer.mozilla.org/ja/docs/Web/HTTP/Reference/Headers/Retry-After?utm_source=chatgpt.com "Retry-After - HTTP - MDN Web Docs"
[4]: https://learn.microsoft.com/en-us/aspnet/core/fundamentals/error-handling-api?view=aspnetcore-10.0 "Handle errors in ASP.NET Core APIs | Microsoft Learn"
